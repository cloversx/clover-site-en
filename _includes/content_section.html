{% comment %}
_includes/content_section.html

Params:
- mode: "featured" | "latest"
- limit: number (optional)
- show_badge: true/false
- featured_style: true/false
- show_date: true/false
{% endcomment %}

{% assign mode = include.mode | default: "latest" %}

{% assign all_items = site.pages
  | where: "layout", "content"
  | where_exp: "p", "p.is_archive != true"
%}

{% if mode == "featured" %}

{% assign items = all_items | where: "featured", true %}
{% if items and items.size > 0 %}

{% assign ranked = items
  | where_exp: "p", "p.featured_rank != nil"
  | sort: "featured_rank"
%}

{% assign unranked = items
  | where_exp: "p", "p.featured_rank == nil"
  | sort: "last_updated"
  | reverse
%}

<ul class="content-list">
{% for p in ranked %}
  {% include content-card.html
    page=p
    featured=true
    show_badge=include.show_badge
    featured_style=include.featured_style
    show_date=include.show_date
  %}
{% endfor %}

{% for p in unranked %}
  {% include content-card.html
    page=p
    featured=true
    show_badge=include.show_badge
    featured_style=include.featured_style
    show_date=include.show_date
  %}
{% endfor %}
</ul>

{% endif %}

{% else %}

{% assign items = all_items | sort: "last_updated" | reverse %}

<ul class="content-list">
{% if include.limit and include.limit != "" %}
{% for p in items limit: include.limit %}
  {% include content-card.html page=p show_date=include.show_date %}
{% endfor %}
{% else %}
{% for p in items %}
  {% include content-card.html page=p show_date=include.show_date %}
{% endfor %}
{% endif %}
</ul>

{% endif %}
